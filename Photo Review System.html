<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π</title>
    <style>
        :root {
            --color-bg-base: #0f172a;
            --color-bg-elevated: #020617;
            --color-bg-surface: #1e293b;
            --color-bg-muted: #334155;
            --color-text-primary: #f1f5f9;
            --color-text-secondary: #cbd5e1;
            --color-text-muted: #94a3b8;
            --color-text-accent: #38bdf8;
            --color-primary: #38bdf8;
            --color-primary-hover: #0ea5e9;
            --color-success: #10b981;
            --color-warning: #f59e0b;
            --color-error: #ef4444;
            --color-border: rgba(203, 213, 225, 0.2);
        }

        @media (prefers-color-scheme: light) {
            :root {
                --color-bg-base: #ffffff;
                --color-bg-elevated: #f8fafc;
                --color-bg-surface: #f1f5f9;
                --color-bg-muted: #e2e8f0;
                --color-text-primary: #0f172a;
                --color-text-secondary: #475569;
                --color-text-muted: #64748b;
                --color-text-accent: #0284c7;
                --color-primary: #0284c7;
                --color-primary-hover: #0369a1;
                --color-border: rgba(15, 23, 42, 0.2);
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--color-bg-base);
            color: var(--color-text-primary);
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: var(--color-primary);
        }

        .tabs {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 12px 24px;
            background: var(--color-bg-surface);
            color: var(--color-text-primary);
            border: 2px solid var(--color-border);
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s;
        }

        .tab-btn:hover {
            background: var(--color-bg-muted);
            border-color: var(--color-primary);
        }

        .tab-btn.active {
            background: var(--color-primary);
            color: var(--color-bg-base);
            border-color: var(--color-primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .form-card {
            background: var(--color-bg-surface);
            border: 1px solid var(--color-border);
            border-radius: 12px;
            padding: 30px;
            max-width: 600px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--color-text-secondary);
        }

        input[type="text"],
        input[type="email"],
        textarea {
            width: 100%;
            padding: 12px;
            background: var(--color-bg-base);
            color: var(--color-text-primary);
            border: 2px solid var(--color-border);
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input:focus,
        textarea:focus {
            outline: none;
            border-color: var(--color-primary);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        .file-upload {
            width: 100%;
            padding: 40px;
            background: var(--color-bg-base);
            border: 3px dashed var(--color-border);
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .file-upload:hover {
            border-color: var(--color-primary);
            background: var(--color-bg-muted);
        }

        .file-upload input {
            display: none;
        }

        .file-preview {
            margin-top: 15px;
            text-align: center;
        }

        .file-preview img {
            max-width: 100%;
            max-height: 300px;
            border-radius: 8px;
            border: 2px solid var(--color-border);
        }

        .btn {
            width: 100%;
            padding: 14px;
            background: var(--color-primary);
            color: var(--color-bg-base);
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn:hover {
            background: var(--color-primary-hover);
            transform: translateY(-2px);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .submissions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .submission-card {
            background: var(--color-bg-surface);
            border: 1px solid var(--color-border);
            border-radius: 12px;
            padding: 20px;
            transition: transform 0.3s;
        }

        .submission-card:hover {
            transform: translateY(-4px);
        }

        .submission-card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .submission-info {
            margin-bottom: 10px;
        }

        .submission-info strong {
            color: var(--color-primary);
        }

        .status-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            margin-top: 10px;
        }

        .status-pending {
            background: var(--color-warning);
            color: var(--color-bg-base);
        }

        .status-approved {
            background: var(--color-success);
            color: var(--color-bg-base);
        }

        .status-rejected {
            background: var(--color-error);
            color: white;
        }

        .admin-controls {
            margin-top: 15px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .admin-controls button {
            flex: 1;
            padding: 8px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: opacity 0.3s;
        }

        .admin-controls button:hover {
            opacity: 0.8;
        }

        .btn-approve {
            background: var(--color-success);
            color: white;
        }

        .btn-reject {
            background: var(--color-error);
            color: white;
        }

        .comment-section {
            margin-top: 10px;
        }

        .comment-section textarea {
            font-size: 14px;
            min-height: 60px;
        }

        .success-message {
            background: var(--color-success);
            color: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 20px;
        }

        .check-status-form {
            max-width: 400px;
            margin: 0 auto;
        }

        .filter-bar {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 16px;
            background: var(--color-bg-surface);
            color: var(--color-text-primary);
            border: 2px solid var(--color-border);
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .filter-btn:hover,
        .filter-btn.active {
            background: var(--color-primary);
            color: var(--color-bg-base);
            border-color: var(--color-primary);
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--color-text-muted);
        }

        .empty-state svg {
            width: 80px;
            height: 80px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }

            .form-card {
                padding: 20px;
            }

            .submissions-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üì∏ –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π</h1>
            <p style="color: var(--color-text-secondary);">–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É –∏–ª–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ —Å—Ç–∞—Ç—É—Å</p>
        </header>

        <div class="tabs">
            <button class="tab-btn active" data-tab="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ</button>
            <button class="tab-btn" data-tab="check">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å</button>
            <button class="tab-btn" data-tab="admin" id="admin-tab-btn" style="display: none;">–ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</button>
        </div>

        <!-- Submit Photo Tab -->
        <div id="submit-tab" class="tab-content active">
            <div class="form-card">
                <h2 style="margin-bottom: 20px; color: var(--color-primary);">–û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏</h2>
                <form id="submit-form">
                    <div class="form-group">
                        <label for="name">–ò–º—è *</label>
                        <input type="text" id="name" required placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è">
                    </div>

                    <div class="form-group">
                        <label for="district">–†–∞–π–æ–Ω *</label>
                        <select id="district" required style="width: 100%; padding: 12px; background: var(--color-bg-base); color: var(--color-text-primary); border: 2px solid var(--color-border); border-radius: 8px; font-size: 16px;">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–π–æ–Ω</option>
                            <option value="–ê–≥—Ä—ã–∑—Å–∫–∏–π">–ê–≥—Ä—ã–∑—Å–∫–∏–π</option>
                            <option value="–ê–∑–Ω–∞–∫–∞–µ–≤—Å–∫–∏–π">–ê–∑–Ω–∞–∫–∞–µ–≤—Å–∫–∏–π</option>
                            <option value="–ê–∫—Å—É–±–∞–µ–≤—Å–∫–∏–π">–ê–∫—Å—É–±–∞–µ–≤—Å–∫–∏–π</option>
                            <option value="–ê–∫—Ç–∞–Ω—ã—à—Å–∫–∏–π">–ê–∫—Ç–∞–Ω—ã—à—Å–∫–∏–π</option>
                            <option value="–ê–ª–µ–∫—Å–µ–µ–≤—Å–∫–∏–π">–ê–ª–µ–∫—Å–µ–µ–≤—Å–∫–∏–π</option>
                            <option value="–ê–ª—å–∫–µ–µ–≤—Å–∫–∏–π">–ê–ª—å–∫–µ–µ–≤—Å–∫–∏–π</option>
                            <option value="–ê–ª—å–º–µ—Ç—å–µ–≤—Å–∫–∏–π">–ê–ª—å–º–µ—Ç—å–µ–≤—Å–∫–∏–π</option>
                            <option value="–ê–ø–∞—Å—Ç–æ–≤—Å–∫–∏–π">–ê–ø–∞—Å—Ç–æ–≤—Å–∫–∏–π</option>
                            <option value="–ê—Ä—Å–∫–∏–π">–ê—Ä—Å–∫–∏–π</option>
                            <option value="–ê—Ç–Ω–∏–Ω—Å–∫–∏–π">–ê—Ç–Ω–∏–Ω—Å–∫–∏–π</option>
                            <option value="–ë–∞–≤–ª–∏–Ω—Å–∫–∏–π">–ë–∞–≤–ª–∏–Ω—Å–∫–∏–π</option>
                            <option value="–ë–∞–ª—Ç–∞—Å–∏–Ω—Å–∫–∏–π">–ë–∞–ª—Ç–∞—Å–∏–Ω—Å–∫–∏–π</option>
                            <option value="–ë—É–≥—É–ª—å–º–∏–Ω—Å–∫–∏–π">–ë—É–≥—É–ª—å–º–∏–Ω—Å–∫–∏–π</option>
                            <option value="–ë—É–∏–Ω—Å–∫–∏–π">–ë—É–∏–Ω—Å–∫–∏–π</option>
                            <option value="–í–µ—Ä—Ö–Ω–µ—É—Å–ª–æ–Ω—Å–∫–∏–π">–í–µ—Ä—Ö–Ω–µ—É—Å–ª–æ–Ω—Å–∫–∏–π</option>
                            <option value="–í—ã—Å–æ–∫–æ–≥–æ—Ä—Å–∫–∏–π">–í—ã—Å–æ–∫–æ–≥–æ—Ä—Å–∫–∏–π</option>
                            <option value="–î—Ä–æ–∂–∂–∞–Ω–æ–≤—Å–∫–∏–π">–î—Ä–æ–∂–∂–∞–Ω–æ–≤—Å–∫–∏–π</option>
                            <option value="–ï–ª–∞–±—É–∂—Å–∫–∏–π">–ï–ª–∞–±—É–∂—Å–∫–∏–π</option>
                            <option value="–ó–∞–∏–Ω—Å–∫–∏–π">–ó–∞–∏–Ω—Å–∫–∏–π</option>
                            <option value="–ó–µ–ª–µ–Ω–æ–¥–æ–ª—å—Å–∫–∏–π">–ó–µ–ª–µ–Ω–æ–¥–æ–ª—å—Å–∫–∏–π</option>
                            <option value="–ö–∞–π–±–∏—Ü–∫–∏–π">–ö–∞–π–±–∏—Ü–∫–∏–π</option>
                            <option value="–ö–∞–º—Å–∫–æ-–£—Å—Ç—å–∏–Ω—Å–∫–∏–π">–ö–∞–º—Å–∫–æ-–£—Å—Ç—å–∏–Ω—Å–∫–∏–π</option>
                            <option value="–ö—É–∫–º–æ—Ä—Å–∫–∏–π">–ö—É–∫–º–æ—Ä—Å–∫–∏–π</option>
                            <option value="–õ–∞–∏—à–µ–≤—Å–∫–∏–π">–õ–∞–∏—à–µ–≤—Å–∫–∏–π</option>
                            <option value="–õ–µ–Ω–∏–Ω–æ–≥–æ—Ä—Å–∫–∏–π">–õ–µ–Ω–∏–Ω–æ–≥–æ—Ä—Å–∫–∏–π</option>
                            <option value="–ú–∞–º–∞–¥—ã—à—Å–∫–∏–π">–ú–∞–º–∞–¥—ã—à—Å–∫–∏–π</option>
                            <option value="–ú–µ–Ω–¥–µ–ª–µ–µ–≤—Å–∫–∏–π">–ú–µ–Ω–¥–µ–ª–µ–µ–≤—Å–∫–∏–π</option>
                            <option value="–ú–µ–Ω–∑–µ–ª–∏–Ω—Å–∫–∏–π">–ú–µ–Ω–∑–µ–ª–∏–Ω—Å–∫–∏–π</option>
                            <option value="–ú—É—Å–ª—é–º–æ–≤—Å–∫–∏–π">–ú—É—Å–ª—é–º–æ–≤—Å–∫–∏–π</option>
                            <option value="–ù–∏–∂–Ω–µ–∫–∞–º—Å–∫–∏–π">–ù–∏–∂–Ω–µ–∫–∞–º—Å–∫–∏–π</option>
                            <option value="–ù–æ–≤–æ—à–µ—à–º–∏–Ω—Å–∫–∏–π">–ù–æ–≤–æ—à–µ—à–º–∏–Ω—Å–∫–∏–π</option>
                            <option value="–ù—É—Ä–ª–∞—Ç—Å–∫–∏–π">–ù—É—Ä–ª–∞—Ç—Å–∫–∏–π</option>
                            <option value="–ü–µ—Å—Ç—Ä–µ—á–∏–Ω—Å–∫–∏–π">–ü–µ—Å—Ç—Ä–µ—á–∏–Ω—Å–∫–∏–π</option>
                            <option value="–†—ã–±–Ω–æ-–°–ª–æ–±–æ–¥—Å–∫–∏–π">–†—ã–±–Ω–æ-–°–ª–æ–±–æ–¥—Å–∫–∏–π</option>
                            <option value="–°–∞–±–∏–Ω—Å–∫–∏–π">–°–∞–±–∏–Ω—Å–∫–∏–π</option>
                            <option value="–°–∞—Ä–º–∞–Ω–æ–≤—Å–∫–∏–π">–°–∞—Ä–º–∞–Ω–æ–≤—Å–∫–∏–π</option>
                            <option value="–°–ø–∞—Å—Å–∫–∏–π">–°–ø–∞—Å—Å–∫–∏–π</option>
                            <option value="–¢–µ—Ç—é—à—Å–∫–∏–π">–¢–µ—Ç—é—à—Å–∫–∏–π</option>
                            <option value="–¢—É–∫–∞–µ–≤—Å–∫–∏–π">–¢—É–∫–∞–µ–≤—Å–∫–∏–π</option>
                            <option value="–¢—é–ª—è—á–∏–Ω—Å–∫–∏–π">–¢—é–ª—è—á–∏–Ω—Å–∫–∏–π</option>
                            <option value="–ß–µ—Ä–µ–º—à–∞–Ω—Å–∫–∏–π">–ß–µ—Ä–µ–º—à–∞–Ω—Å–∫–∏–π</option>
                            <option value="–ß–∏—Å—Ç–æ–ø–æ–ª—å—Å–∫–∏–π">–ß–∏—Å—Ç–æ–ø–æ–ª—å—Å–∫–∏–π</option>
                            <option value="–Æ—Ç–∞–∑–∏–Ω—Å–∫–∏–π">–Æ—Ç–∞–∑–∏–Ω—Å–∫–∏–π</option>
                            <option value="–≥. –ö–∞–∑–∞–Ω—å">–≥. –ö–∞–∑–∞–Ω—å</option>
                            <option value="–≥. –ù–∞–±–µ—Ä–µ–∂–Ω—ã–µ –ß–µ–ª–Ω—ã">–≥. –ù–∞–±–µ—Ä–µ–∂–Ω—ã–µ –ß–µ–ª–Ω—ã</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="email">Email *</label>
                        <input type="email" id="email" required placeholder="your@email.com">
                    </div>

                    <div class="form-group">
                        <label for="phone">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                        <input type="text" id="phone" placeholder="+7 (999) 123-45-67">
                    </div>

                    <div class="form-group">
                        <label for="comment">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</label>
                        <textarea id="comment" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)"></textarea>
                    </div>

                    <div class="form-group">
                        <label>–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ *</label>
                        <div class="file-upload" id="file-upload">
                            <input type="file" id="photo" accept="image/*" required multiple>
                            <p style="color: var(--color-text-muted);">
                                üìÅ –ù–∞–∂–º–∏—Ç–µ –∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–æ—Ç–æ (–º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ)<br>
                                <small>–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è: –º–∏–Ω. 2000px –ø–æ –≤—ã—Å–æ—Ç–µ, –º–∏–Ω. 250 –ö–ë<br>JPG, PNG, WEBP</small>
                            </p>
                        </div>
                        <div class="file-preview" id="file-preview"></div>
                    </div>

                    <button type="submit" class="btn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É</button>
                </form>
            </div>
        </div>

        <!-- Check Status Tab -->
        <div id="check-tab" class="tab-content">
            <div class="form-card check-status-form">
                <h2 style="margin-bottom: 20px; color: var(--color-primary);">–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞</h2>
                <form id="check-form">
                    <div class="form-group">
                        <label for="check-email">Email</label>
                        <input type="email" id="check-email" required placeholder="your@email.com">
                    </div>
                    <button type="submit" class="btn">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
                </form>

                <div id="status-result" style="margin-top: 30px;"></div>
            </div>
        </div>

        <!-- Admin Tab -->
        <div id="admin-tab" class="tab-content">
            <div class="filter-bar">
                <button class="filter-btn active" data-filter="all">–í—Å–µ</button>
                <button class="filter-btn" data-filter="pending">–ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ</button>
                <button class="filter-btn" data-filter="approved">–û–¥–æ–±—Ä–µ–Ω–æ</button>
                <button class="filter-btn" data-filter="rejected">–û—Ç–∫–ª–æ–Ω–µ–Ω–æ</button>
            </div>

            <div class="submissions-grid" id="admin-list"></div>
        </div>
    </div>

    <script>
        // Database simulation
        let submissions = [];
        let currentFilter = 'all';
        let isAdminAuthenticated = false;

        // Check for admin access in URL
        const urlParams = new URLSearchParams(window.location.search);
        if (window.location.pathname === '/admin' || urlParams.get('admin') === 'true') {
            const username = prompt('–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω:');
            const password = prompt('–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å:');
            
            if (username === 'admin' && password === '1982@Sd') {
                isAdminAuthenticated = true;
                document.getElementById('admin-tab-btn').style.display = 'block';
                document.getElementById('admin-tab-btn').click();
            } else {
                alert('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å');
                window.location.href = '/';
            }
        }

        // Tab switching
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const tabName = btn.dataset.tab;
                
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                btn.classList.add('active');
                document.getElementById(`${tabName}-tab`).classList.add('active');

                if (tabName === 'admin') {
                    renderAdminList();
                }
            });
        });

        // File upload preview
        const fileUpload = document.getElementById('file-upload');
        const photoInput = document.getElementById('photo');
        const filePreview = document.getElementById('file-preview');

        fileUpload.addEventListener('click', () => photoInput.click());

        fileUpload.addEventListener('dragover', (e) => {
            e.preventDefault();
            fileUpload.style.borderColor = 'var(--color-primary)';
        });

        fileUpload.addEventListener('dragleave', () => {
            fileUpload.style.borderColor = 'var(--color-border)';
        });

        fileUpload.addEventListener('drop', (e) => {
            e.preventDefault();
            fileUpload.style.borderColor = 'var(--color-border)';
            
            if (e.dataTransfer.files.length) {
                photoInput.files = e.dataTransfer.files;
                previewFile(e.dataTransfer.files[0]);
            }
        });

        photoInput.addEventListener('change', (e) => {
            if (e.target.files.length) {
                validateAndPreviewFiles(e.target.files);
            }
        });

        function validateAndPreviewFiles(files) {
            filePreview.innerHTML = '';
            let allValid = true;

            Array.from(files).forEach(file => {
                const minSize = 250 * 1024;
                if (file.size < minSize) {
                    alert(`‚ùå –§–∞–π–ª ${file.name} —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–π. –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 250 –ö–ë`);
                    allValid = false;
                    return;
                }

                const reader = new FileReader();
                reader.onload = (e) => {
                    const img = new Image();
                    img.onload = () => {
                        if (img.height < 2000) {
                            alert(`‚ùå –í—ã—Å–æ—Ç–∞ —Ñ–æ—Ç–æ ${file.name} —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∞—è. –ú–∏–Ω–∏–º—É–º: 2000px. –í—ã—Å–æ—Ç–∞: ${img.height}px`);
                            allValid = false;
                            return;
                        }

                        const imgDiv = document.createElement('div');
                        imgDiv.style.marginTop = '15px';
                        imgDiv.innerHTML = `
                            <img src="${e.target.result}" alt="Preview" style="max-width: 100%; max-height: 200px; border-radius: 8px; border: 2px solid var(--color-border);">
                            <p style="margin-top: 5px; color: var(--color-text-muted); font-size: 14px;">
                                ${file.name} (${(file.size / 1024 / 1024).toFixed(2)} –ú–ë) - ${img.width}√ó${img.height}px
                            </p>
                        `;
                        filePreview.appendChild(imgDiv);
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(file);
            });

            if (!allValid) {
                photoInput.value = '';
                filePreview.innerHTML = '';
            }
        }

        function validateAndPreviewFile(file) {
            // Validate file size (min 250 KB)
            const minSize = 250 * 1024; // 250 KB in bytes
            if (file.size < minSize) {
                alert(`‚ùå –§–∞–π–ª —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–π. –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 250 –ö–ë. –í–∞—à —Ñ–∞–π–ª: ${(file.size / 1024).toFixed(0)} –ö–ë`);
                photoInput.value = '';
                filePreview.innerHTML = '';
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                const img = new Image();
                img.onload = () => {
                    // Validate image height (min 2000px)
                    if (img.height < 2000) {
                        alert(`‚ùå –í—ã—Å–æ—Ç–∞ —Ñ–æ—Ç–æ —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∞—è. –ú–∏–Ω–∏–º—É–º: 2000px. –í–∞—à–µ —Ñ–æ—Ç–æ: ${img.height}px`);
                        photoInput.value = '';
                        filePreview.innerHTML = '';
                        return;
                    }

                    // If validation passed, show preview
                    filePreview.innerHTML = `
                        <img src="${e.target.result}" alt="Preview">
                        <p style="margin-top: 10px; color: var(--color-text-muted);">
                            ${file.name} (${(file.size / 1024 / 1024).toFixed(2)} –ú–ë)<br>
                            –†–∞–∑–º–µ—Ä: ${img.width}√ó${img.height}px
                        </p>
                    `;
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function previewFile(file) {
            validateAndPreviewFiles([file]);
        }

        // Submit form
        document.getElementById('submit-form').addEventListener('submit', (e) => {
            e.preventDefault();

            const email = document.getElementById('email').value;
            
            // Collect all photos
            const photos = Array.from(filePreview.querySelectorAll('img')).map(img => img.src);
            
            // Check if user with this email already exists
            let existingUser = submissions.find(s => s.email === email);

            if (existingUser) {
                // Update existing user's photo and info
                existingUser.name = document.getElementById('name').value;
                existingUser.district = document.getElementById('district').value;
                existingUser.phone = document.getElementById('phone').value;
                existingUser.comment = document.getElementById('comment').value;
                existingUser.photos = photos;
                existingUser.status = 'pending';
                existingUser.adminComment = '';
                existingUser.updatedAt = new Date().toLocaleString('ru-RU');
            } else {
                // Create new submission
                const formData = {
                    id: Date.now(),
                    name: document.getElementById('name').value,
                    district: document.getElementById('district').value,
                    email: document.getElementById('email').value,
                    phone: document.getElementById('phone').value,
                    comment: document.getElementById('comment').value,
                    photos: photos,
                    originals: [],
                    status: 'pending',
                    adminComment: '',
                    createdAt: new Date().toLocaleString('ru-RU')
                };
                submissions.push(formData);
            }

            // Show success message
            const form = document.getElementById('submit-form');
            const submissionId = existingUser ? existingUser.id : submissions[submissions.length - 1].id;
            form.innerHTML = `
                <div class="success-message">
                    <h3>‚úÖ –§–æ—Ç–æ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!</h3>
                    <p style="margin-top: 10px;">–°—Ç–∞—Ç—É—Å: <strong>–ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ</strong></p>
                    <p>ID –∑–∞—è–≤–∫–∏: <strong>${submissionId}</strong></p>
                    <p style="margin-top: 15px;">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –º–æ–∂–Ω–æ –≤–æ –≤–∫–ª–∞–¥–∫–µ "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å"</p>
                    <button onclick="location.reload()" style="margin-top: 20px; padding: 10px 20px; background: white; color: var(--color-success); border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                        –û—Ç–ø—Ä–∞–≤–∏—Ç—å –µ—â—ë
                    </button>
                </div>
            `;
        });

        // Check status form
        document.getElementById('check-form').addEventListener('submit', (e) => {
            e.preventDefault();

            const email = document.getElementById('check-email').value;
            const userSubmissions = submissions.filter(s => s.email === email);

            const resultDiv = document.getElementById('status-result');

            if (userSubmissions.length === 0) {
                resultDiv.innerHTML = `
                    <div class="empty-state">
                        <p>–ó–∞—è–≤–∫–∏ —Å —Ç–∞–∫–∏–º email –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
                    </div>
                `;
                return;
            }

            resultDiv.innerHTML = userSubmissions.map(sub => `
                <div class="submission-card">
                    ${sub.photos ? sub.photos.map(photo => `<img src="${photo}" alt="Photo">`).join('') : `<img src="${sub.photo}" alt="Photo">`}
                    <div class="submission-info">
                        <strong>ID:</strong> ${sub.id}<br>
                        <strong>–î–∞—Ç–∞:</strong> ${sub.createdAt}
                    </div>
                    <span class="status-badge status-${sub.status}">
                        ${sub.status === 'pending' ? '‚è≥ –ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ' : sub.status === 'approved' ? '‚úÖ –û–¥–æ–±—Ä–µ–Ω–æ' : '‚ùå –ó–∞–ø—Ä–æ—Å–∏—Ç—å –Ω–æ–≤–æ–µ —Ñ–æ—Ç–æ'}
                    </span>
                    ${sub.adminComment ? `<p style="margin-top: 10px; padding: 10px; background: var(--color-bg-muted); border-radius: 6px; font-size: 14px;"><strong>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</strong> ${sub.adminComment}</p>` : ''}
                    
                    ${sub.status === 'approved' && (!sub.originals || sub.originals.length === 0) ? `
                        <div style="margin-top: 15px; padding: 15px; background: var(--color-success); color: white; border-radius: 8px;">
                            <strong>‚úÖ –§–æ—Ç–æ –æ–¥–æ–±—Ä–µ–Ω–æ!</strong>
                            <p style="margin-top: 10px; font-size: 14px;">–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª—ã (PSD, RAW –∏ –¥—Ä.)</p>
                            <div style="margin-top: 10px;">
                                <input type="file" id="upload-originals-${sub.id}" multiple style="display: none;">
                                <button onclick="document.getElementById('upload-originals-${sub.id}').click()" style="padding: 8px 16px; background: white; color: var(--color-success); border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                                    üì¶ –ó–∞–≥—Ä—É–∑–∏—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª—ã
                                </button>
                            </div>
                            <div id="originals-preview-${sub.id}" style="margin-top: 10px;"></div>
                        </div>
                    ` : ''}
                    
                    ${sub.originals && sub.originals.length > 0 ? `
                        <div style="margin-top: 10px; padding: 10px; background: var(--color-bg-muted); border-radius: 6px;">
                            <strong style="color: var(--color-primary);">üì¶ –û—Ä–∏–≥–∏–Ω–∞–ª—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã:</strong><br>
                            ${sub.originals.map(orig => `
                                <div style="margin-top: 5px; font-size: 14px;">
                                    üìÑ ${orig.name} (${(orig.size / 1024 / 1024).toFixed(2)} –ú–ë)
                                </div>
                            `).join('')}
                        </div>
                    ` : ''}
                </div>
            `).join('');
            
            // Add event listeners for originals upload in user status check
            userSubmissions.forEach(sub => {
                if (sub.status === 'approved' && (!sub.originals || sub.originals.length === 0)) {
                    const uploadInput = document.getElementById(`upload-originals-${sub.id}`);
                    if (uploadInput) {
                        uploadInput.addEventListener('change', (e) => {
                            if (e.target.files.length) {
                                uploadOriginalsForSubmission(sub.id, e.target.files);
                            }
                        });
                    }
                }
            });
        });

        // Admin panel filters
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentFilter = btn.dataset.filter;
                renderAdminList();
            });
        });

        function renderAdminList() {
            const adminList = document.getElementById('admin-list');
            
            let filtered = submissions;
            if (currentFilter !== 'all') {
                filtered = submissions.filter(s => s.status === currentFilter);
            }

            if (filtered.length === 0) {
                adminList.innerHTML = `
                    <div class="empty-state" style="grid-column: 1/-1;">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4" />
                        </svg>
                        <h3>–ù–µ—Ç –∑–∞—è–≤–æ–∫</h3>
                        <p>–ó–∞—è–≤–∫–∏ —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º —Å—Ç–∞—Ç—É—Å–æ–º –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
                    </div>
                `;
                return;
            }

            adminList.innerHTML = filtered.map(sub => `
                <div class="submission-card">
                    ${sub.photos ? sub.photos.map(photo => `<img src="${photo}" alt="Photo" style="margin-bottom: 10px;">`).join('') : `<img src="${sub.photo}" alt="Photo">`}
                    <div class="submission-info">
                        <strong>–ò–º—è:</strong> ${sub.name}<br>
                        <strong>–†–∞–π–æ–Ω:</strong> ${sub.district}<br>
                        <strong>Email:</strong> ${sub.email}<br>
                        ${sub.phone ? `<strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> ${sub.phone}<br>` : ''}
                        <strong>–î–∞—Ç–∞:</strong> ${sub.createdAt}<br>
                        ${sub.comment ? `<strong>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</strong> ${sub.comment}<br>` : ''}
                        ${sub.originals && sub.originals.length > 0 ? `<strong>–û—Ä–∏–≥–∏–Ω–∞–ª—ã:</strong> ${sub.originals.length} —Ñ–∞–π–ª(–æ–≤)<br>` : ''}
                    </div>
                    ${sub.originals && sub.originals.length > 0 ? `
                        <div style="margin-top: 10px; padding: 10px; background: var(--color-bg-muted); border-radius: 6px;">
                            <strong style="color: var(--color-primary);">üì¶ –û—Ä–∏–≥–∏–Ω–∞–ª—ã (${sub.originals.length}):</strong><br>
                            ${sub.originals.map((orig, idx) => `
                                <div style="margin-top: 5px; display: flex; justify-content: space-between; align-items: center;">
                                    <span style="font-size: 14px;">üìÑ ${orig.name} (${(orig.size / 1024 / 1024).toFixed(2)} –ú–ë)</span>
                                    <a href="${orig.data}" download="${orig.name}" style="padding: 4px 8px; background: var(--color-primary); color: white; border-radius: 4px; font-size: 12px; text-decoration: none;">‚¨á –°–∫–∞—á–∞—Ç—å</a>
                                </div>
                            `).join('')}
                        </div>
                    ` : ''}
                    <span class="status-badge status-${sub.status}">
                        ${sub.status === 'pending' ? '‚è≥ –ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ' : sub.status === 'approved' ? '‚úÖ –û–¥–æ–±—Ä–µ–Ω–æ' : '‚ùå –û—Ç–∫–ª–æ–Ω–µ–Ω–æ'}
                    </span>

                    <div class="admin-controls">
                        <button class="btn-approve" onclick="changeStatus(${sub.id}, 'approved')">‚úÖ –û–¥–æ–±—Ä–∏—Ç—å</button>
                        <button class="btn-reject" onclick="changeStatus(${sub.id}, 'rejected')">‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
                    </div>

                    <div class="comment-section">
                        <textarea id="comment-${sub.id}" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...">${sub.adminComment || ''}</textarea>
                        <button onclick="saveComment(${sub.id})" style="width: 100%; margin-top: 5px; padding: 8px; background: var(--color-bg-muted); color: var(--color-text-primary); border: none; border-radius: 6px; cursor: pointer;">
                            –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function changeStatus(id, newStatus) {
            const submission = submissions.find(s => s.id === id);
            if (submission) {
                submission.status = newStatus;
                renderAdminList();
            }
        }

        function saveComment(id) {
            const submission = submissions.find(s => s.id === id);
            const commentText = document.getElementById(`comment-${id}`).value;
            if (submission) {
                submission.adminComment = commentText;
                alert('–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å–æ—Ö—Ä–∞–Ω—ë–Ω ‚úÖ');
            }
        }

        function uploadOriginalsForSubmission(submissionId, files) {
            const submission = submissions.find(s => s.id === submissionId);
            if (!submission) return;

            const originalsFiles = [];
            let filesProcessed = 0;

            Array.from(files).forEach(file => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    originalsFiles.push({
                        name: file.name,
                        size: file.size,
                        data: e.target.result
                    });
                    filesProcessed++;

                    if (filesProcessed === files.length) {
                        submission.originals = originalsFiles;
                        alert(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${originalsFiles.length} —Ñ–∞–π–ª(–æ–≤) –æ—Ä–∏–≥–∏–Ω–∞–ª–æ–≤`);
                        
                        // Refresh status display
                        document.getElementById('check-form').dispatchEvent(new Event('submit', { cancelable: true }));
                    }
                };
                reader.readAsDataURL(file);
            });

            // Show preview
            const previewDiv = document.getElementById(`originals-preview-${submissionId}`);
            if (previewDiv) {
                previewDiv.innerHTML = Array.from(files).map(file => `
                    <div style="margin-top: 5px; padding: 5px; background: rgba(255,255,255,0.2); border-radius: 4px; font-size: 12px;">
                        üìÑ ${file.name} (${(file.size / 1024 / 1024).toFixed(2)} –ú–ë)
                    </div>
                `).join('');
            }
        }

        // Initial render
        renderAdminList();
    </script>
</body>
</html>

